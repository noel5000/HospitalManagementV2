<nb-card>
  <nb-card-header>
    <div class="row">
      <div class="col-md-6">{{'insuranceCoveragesReport_menu' | translate}}</div>
      <div class="col-md-3">
        <button type="button" class="btn btn-primary" (click)="print()">{{'print_btn' | translate}}</button>
    </div>
    <div class="col-md-3">
      <button type="button" class="btn btn-success" (click)="exportToCSV()">{{'export_btn' | translate}}</button>
  </div>
    </div>
   
  </nb-card-header>

  <nb-card-body>
<div id="filter" class="dontPrint" >
  <form [formGroup]="itemForm" (ngSubmit)="getData()">
<div class="form-row">
  <div class="form-group col-md-6 col-xs-12">
    <label>{{'branchOffice_lbl' | translate}}</label>
    <select class="form-control"
    formControlName="branchOfficeId"
    
    >
    <option *ngFor="let branchoffice of branchOffices"
     [value]="branchoffice.id"
     >{{branchoffice.name}}</option>
    </select>
</div>

<div class="form-group col-md-6 col-xs-12">
  <label>{{'insurance_lbl' | translate}}</label>
  <select class="form-control"
  formControlName="insuranceId"
  
  >
  <option *ngFor="let insurance of insurances"
   [value]="insurance.id"
   >{{insurance.name}}</option>
  </select>
</div>

<div class="form-group col-md-6 col-xs-12" *ngIf="false">
  <label>{{'insurancePlan_lbl' | translate}}</label>
  <select class="form-control"
  formControlName="insurancePlanId"
  
  >
  <option *ngFor="let insurancePlan of insurancePlans"
   [value]="insurancePlan.id"
   >{{insurancePlan.name}}</option>
  </select>
</div>

<div class="form-group col-md-6 col-xs-12">
  <label>{{'currency_lbl' | translate}}</label>
  <select class="form-control"
  formControlName="currencyId"
  
  >
  <option *ngFor="let currency of currencies"
   [value]="currency.id"
   >{{currency.code}}</option>
  </select>
</div>

<div class="form-group col-md-6 col-xs-12">
  <label>{{'startDate_lbl' | translate}}</label>
  <input type="date" formControlName="startDate" class="form-control" />
</div>
<div class="form-group col-md-6 col-xs-12">
  <label>{{'endDate_lbl' | translate}}</label>
  <input type="date" formControlName="endDate" class="form-control" />
</div>
</div>
  </form>
</div>
<div id="body">
  <table class="table">
    <thead>
      <tr>
        <th>{{'patient_lbl' | translate}}</th>
        <th>{{'cardId_lbl' | translate}}</th>
        <th>{{'insuranceCardId_lbl' | translate}}</th>
        <th>{{'insurance_lbl' | translate}}</th>
        <th>{{'insurancePlan_lbl' | translate}}</th>
        <th>{{'invoiceNumber_lbl' | translate}}</th>
        <th>{{'date_lbl' | translate}}</th>
        <th>{{'product_lbl' | translate}}</th>
        <th>{{'currency_lbl' | translate}}</th>
        <th>{{'totalAmount_lbl' | translate}}</th>
        <th>{{'insuranceCoverageAmount_lbl' | translate}}</th>
        <th>{{'patientPaymentAmount_lbl' | translate}}</th>
        <th>{{'daysAmount_lbl' | translate}}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor=" let invoice of invoices">
        <td>{{invoice.patientName}}</td>
        <td>{{invoice.patientCardId}}</td>
        <td>{{invoice.insuranceCardId}}</td>
        <td>{{invoice.insurance?invoice.insurance.name:''}}</td>
        <td>{{invoice.insurancePlan?invoice.insurancePlan.name:''}}</td>
        <td>{{invoice.invoiceNumber}}</td>
        <td>{{invoice.date | date:"shortDate"}}</td>
        <td>{{invoice.product.name}}</td>
        <td>{{invoice.currency.code}}</td>
        <td>{{invoice.totalAmount | currency:"" }}</td>
        <td>{{invoice.insuranceCoverageAmount | currency:"" }}</td>
        <td>{{invoice.patientPaymentAmount | currency:"" }}</td>
        <td>{{invoice.daysAmount}}</td>

      </tr>
    </tbody>
      </table>
      <hr>
      <table *ngIf="invoices && invoices.length>0" class="table table-bordered text-center">
        <thead>
          <tr>
            <th >{{'totalBilled_lbl' | translate}}</th>
            <th >{{'totalInsuranceCoverage_lbl' | translate}}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td >{{getTotalAmount(invoices,'patientPaymentAmount') | currency:""}}</td>
            <td >{{getTotalAmount(invoices,'insuranceCoverageAmount') | currency:""}}</td>
          </tr>
        </tbody>
      </table>

</div>
  </nb-card-body>
</nb-card>

